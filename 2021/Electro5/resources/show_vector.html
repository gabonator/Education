<body bgcolor=black>
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/highlight.min.js"></script>

<table><tr><td>
<canvas id="canvas" style="border:8px solid #000000; width:640px; height:320; overflow:right;"></canvas>
</td><td>
<pre style="width:500px; background:#f0f0f0" id="pre1"><code id="code1" class="language-cpp"></code></pre>
</td></tr></table>

<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext('2d');
canvas.width = 640;
canvas.height = 320;

function showPixel(_x, _y)
{
  var dx = _x < 64 ? 30 : -30;
  var dy = _y < 32 ? 10 : -10;

  x = _x * 5 + 2;
  y = _y * 5 + 2;
  ctx.strokeStyle = "#ff5555";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(x, y);
  ctx.lineTo(x+dx, y+dy);
  ctx.stroke();
  ctx.font = "20px Arial";
  ctx.fillStyle = "#ff5555";
  ctx.textAlign = dx < 0 ? "right" : "left";
  ctx.fillText("("+_x+", "+_y+")", x+dx, y+dy);
}

function draw()
{
  ctx.fillStyle = "#000000";
  ctx.fillRect(0, 0, 1000, 1000);
  for (var y=0; y<64; y++)
    for (var x=0; x<128; x++)
    {
/*
      var page = Math.floor(y/8);
      var index = page*128+x;
      var bit = y%8;
      var dword = buf ? buf[Math.floor(index/4)] : 0;
      var byte = (dword >> (((index&3))*8) ) & 0xff;
      var pix = (byte >> (bit)) & 1;
*/
      var pix = buf[y*128 + x];
      ctx.fillStyle = pix ? "#d0d0d0" : "#202020";
      ctx.fillRect(x*5, y*5, 4, 4);
    }
}


var buf = new Array(128*64).fill(0);

draw();

function clear()
{
  buf = new Array(128*64).fill(0);
}

function putpixel(x, y)
{
  if (x>=0 && x <= 127 && y >= 0 && y <= 63)
  buf[Math.floor(x) + Math.floor(y)*128] = 1;

}

function line(x1, y1, x2, y2)
{
  var l = Math.max(Math.abs(x2-x1), Math.abs(y2-y1));
  for (var i=0; i<=l; i++)
    putpixel(x1 + (x2-x1)*i/l, y1 + (y2-y1)*i/l);
}

function rect(x1, y1, x2, y2)
{
  line(x1, y1, x2, y1);
  line(x2, y1, x2, y2);
  line(x2, y2, x1, y2);
  line(x1, y2, x1, y1);
}

function poly(arr)
{
  for (var i=0; i<arr.length; i+=4)
    line(arr[i], arr[i+1], arr[i+2], arr[i+3]);
}

function translate(p, x, y)
{
  for (var i=0; i<p.length; i+=2)
  {
    p[i] += x;
    p[i+1] += y;
  }
}

function scale(p, x, y)
{
  for (var i=0; i<p.length; i+=2)
  {
    p[i] *= x;
    p[i+1] *= y;
  }
}

function rotate(p, a)
{
  for (var i=0; i<p.length; i+=2)
  {
    var x = p[i];
    var y = p[i+1];
    var angle = Math.atan2(y, x);
    var dist = Math.sqrt(x*x + y*y);
    angle += a;
    x = Math.cos(angle)*dist;
    y = Math.sin(angle)*dist;
    p[i] = x;
    p[i+1] = y;
  }
}

var dscale = true;
var drotate = true;

var bx = 128/2-5;
var by = 64/2-5;
var dx = 0;
var dy = 0;
setInterval(() =>
{
  var a  = new Date().getTime()/1000;
  clear();
  var p = [
  20, 60, 40, 5,
  40, 5,  50, 5,
  50, 5,  70, 60,
  70, 60, 60, 60,
  60, 60, 52, 40,
  52, 40, 38, 40,
  38, 40, 30, 60,
  30, 60, 20, 60,
  45, 15, 50, 30,
  50, 30, 40, 30,
  40, 30, 45, 15
  ];
  translate(p, -45, -30);
  if (dscale)
    scale(p, Math.cos(a/3), Math.cos(a/3));
  if (drotate)
    rotate(p, Math.cos(a)*2);
  translate(p, 64, 32);
  poly(p); 
  draw();
}, 50);

var hash = document.location.hash;

if (hash.substr(0, 1) == "#")
{
  var vals = hash.substr(1).split(",")
  dscale = parseInt(vals[0]);
  drotate = parseInt(vals[1]);
}

</script>